import{j as e,V as P,b as S,r as n,S as B,a as v,J as I,G as i,L as C,B as l,T as y,e as g,o as b,u as R,K as $}from"./index-CsrR-wrF.js";/* empty css                    */import{A as k,H as E}from"./checklist-DckYB8Ak.js";const L=({schema:s,setFormSubmission:u})=>{const t=a=>{a!=null&&a.data&&a.changed&&u(a.data)};return e.jsx("div",{style:{margin:"30px 0px",width:"100%"},children:e.jsx(P.Form,{src:s,onChange:t})})},z=({preInspectionChecklists:s,inspectionID:u})=>{const t=S(),[a,d]=n.useState({});n.useState("");const m=n.useRef(0),{snack:x,setSnack:o}=n.useContext(B),r=v(),[w,h]=n.useState(!1);n.useRef([]);const[N,F]=n.useState({});I("input")`
        clip: rect(0 0 0 0);
        clip-path: inset(50%);
        height: 1px;
        overflow: hidden;
        position: absolute;
        bottom: 0;
        left: 0;
        white-space: nowrap;
        width: 1px;
    `,n.useEffect(()=>{s!=null&&s.schema&&d(JSON.parse(s==null?void 0:s.schema))},[s]);const f=async j=>{var p;try{h(!0);const c=await b({method:"post",url:`http://52.140.64.177:9090/submitPreInspection/${u}`,data:{name:s==null?void 0:s.name,schema:JSON.stringify(N)}});((p=c==null?void 0:c.data)==null?void 0:p.status)==="Failure"?o({open:!0,message:"Something went wrong. Please try again later.",severity:"error"}):(j==="save"&&o({open:!0,message:"Pre Inspection Saved successfully.",severity:"success"}),j==="submit"&&(o({open:!0,message:"Pre Inspection submitted successfully.",severity:"success"}),r("/cases"))),h(!1)}catch(c){console.log(c),h(!1)}};return e.jsx(e.Fragment,{children:e.jsxs(i,{container:!0,spacing:2.5,sx:{m:2.5},children:[w&&e.jsx(C,{}),e.jsx(i,{size:3,className:"categoryContainer",children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{backgroundColor:t.palette.colors[20]},children:[e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(k,{sx:{fontSize:30}}),e.jsx(y,{className:"typographyFontWeight",children:"Pre Inspection Checklist"})]}),e.jsx(l,{display:"flex",pr:2,children:e.jsxs(y,{className:"typographyFontWeight",children:[m.current,"/",a==null?void 0:a.length]})})]})}),e.jsxs(i,{size:9,className:"checklistContainer",children:[e.jsx(i,{container:!0,className:"categoryChecklistContainer",children:e.jsx(L,{schema:a,setFormSubmission:F})}),e.jsxs(i,{container:!0,sx:{justifyContent:"flex-end",my:3},columnGap:3,children:[e.jsx(g,{variant:"outlined",className:"saveButton",onClick:()=>{f("save")},children:"Save"}),e.jsx(g,{className:"nextSubmitButton",onClick:()=>{f("submit")},children:"Submit"})]})]})]})})},T=()=>{var x;const s=S(),t=(x=R().state)==null?void 0:x.caseDetails,[a,d]=n.useState([]),m=v();return n.useEffect(()=>{const o=async()=>{const r=await b({method:"get",url:`http://52.140.64.177:9090/getPreInsForm/${t==null?void 0:t.inspectionID}`});d(r==null?void 0:r.data)};t!=null&&t.inspectionID&&o()},[t==null?void 0:t.inspectionID]),e.jsx(e.Fragment,{children:e.jsxs(l,{className:"inspectionContainer",children:[e.jsx(g,{className:"backButton",startIcon:e.jsx($,{}),onClick:()=>m(-1),children:"Back"}),e.jsxs(l,{display:"flex",flexDirection:"column",sx:{borderRadius:"10px",background:`${s.palette.colors[1]} 0% 0% no-repeat padding-box`,mt:1},children:[e.jsx(E,{caseDetails:t}),e.jsx(z,{preInspectionChecklists:a,inspectionID:t==null?void 0:t.inspectionID})]})]})})};export{T as default};

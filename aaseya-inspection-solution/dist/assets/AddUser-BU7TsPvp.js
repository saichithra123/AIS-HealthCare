import{b as Me,a as Fe,u as Ee,r as c,S as Ue,J as Ae,j as e,B as u,e as C,K as Re,T as p,D as G,L as $e,G as h,i as F,p as de,h as B,M as y,a7 as le,N as Ge,ap as Be,aD as Ye,d as b,a5 as Pe,f as ce,A as xe,g as ue,I as he,o as w}from"./index-CsrR-wrF.js";/* empty css                    */import{A as We}from"./PlaylistAddOutlined-CpSMRKtR.js";import{C as Te}from"./Check-cGaUIAku.js";import{C as pe}from"./Close-CoWB75cj.js";const ze=()=>{var H,q,K;const d=Me(),E=Fe(),me=Ee(),[S,f]=c.useState([]),[Y,P]=c.useState(null),[W,T]=c.useState(null),[o,I]=c.useState({userName:"",phoneNumber:"",emailID:"",role:"Admin",zones:[],userID:""}),[ge,U]=c.useState(!1),[j,fe]=c.useState([]),[D,je]=c.useState([]),[l,A]=c.useState([]),[O,R]=c.useState(!1),v=(H=me.state)==null?void 0:H.userEmail,$=c.useRef(null),L=c.useRef(null),[De,N]=c.useState(!1),{snack:Oe,setSnack:M}=c.useContext(Ue),be=Ae("input")`
        clip: rect(0 0 0 0);
        clip-path: inset(50%);
        height: 1px;
        overflow: hidden;
        position: absolute;
        bottom: 0;
        left: 0;
        white-space: nowrap;
        width: 1px;
    `,Se=[{field:"skill",headerName:"Skills",flex:.5,valueGetter:t=>{var a;return(a=j==null?void 0:j.find(r=>(r==null?void 0:r.skillId)===t))==null?void 0:a.skill},renderCell:t=>{var a;return e.jsx(e.Fragment,{children:t.row.isEditSkill?e.jsx(u,{className:"tableFields",children:e.jsx(B,{value:t.row.skill,fullWidth:!0,onChange:r=>f(s=>s.map(n=>n.id===t.row.id?{...n,skill:r.target.value}:n)),children:j==null?void 0:j.map(r=>e.jsx(y,{value:r==null?void 0:r.skillId,children:r==null?void 0:r.skill},r==null?void 0:r.skillId))})}):(a=j==null?void 0:j.find(r=>{var s;return(r==null?void 0:r.skillId)===((s=t.row)==null?void 0:s.skill)}))==null?void 0:a.skill})}},{field:"startDate",headerName:"Start Date",flex:.5,renderCell:t=>{var a,r,s,n;return e.jsx(e.Fragment,{children:(a=t==null?void 0:t.row)!=null&&a.isEditSkill?e.jsx(e.Fragment,{children:e.jsx(ce,{dateAdapter:xe,children:e.jsx(ue,{size:"small",format:"DD-MMM-YYYY",value:(r=t.row)!=null&&r.startDate?b((s=t.row)==null?void 0:s.startDate):b(Date()),onChange:i=>f(m=>m.map(g=>g.id===t.row.id?{...g,startDate:i}:g)),className:"tableFields",sx:{width:"100%",mt:"4px"},fullWidth:!0,required:!0})})}):b((n=t.row)==null?void 0:n.startDate).format("DD MMM YYYY")})}},{field:"expiryDate",headerName:"Expiry Date",flex:.5,renderCell:t=>{var a,r,s,n;return e.jsx(e.Fragment,{children:(a=t==null?void 0:t.row)!=null&&a.isEditSkill?e.jsx(e.Fragment,{children:e.jsx(ce,{dateAdapter:xe,children:e.jsx(ue,{size:"small",format:"DD-MMM-YYYY",value:(r=t.row)!=null&&r.expiryDate?b((s=t.row)==null?void 0:s.expiryDate):b(Date()),onChange:i=>f(m=>m.map(g=>g.id===t.row.id?{...g,expiryDate:i}:g)),className:"tableFields",sx:{width:"100%",mt:"4px"},fullWidth:!0,required:!0})})}):b((n=t.row)==null?void 0:n.expiryDate).format("DD MMM YYYY")})}},{field:"action",headerName:"Actions",flex:.5,renderCell:t=>{var a;return e.jsx(e.Fragment,{children:(a=t==null?void 0:t.row)!=null&&a.isEditSkill?e.jsx(e.Fragment,{children:e.jsxs(u,{children:[e.jsx(he,{onClick:()=>{U(!1),f(r=>r.filter(s=>s.id!==t.row.id))},children:e.jsx(pe,{sx:{color:"#d54b4b",fontWeight:"bold"}})}),e.jsx(he,{onClick:()=>{U(!1),f(r=>r.map(s=>s.id===t.row.id?{...s,isEditSkill:!s.isEditSkill}:s))},children:e.jsx(Te,{sx:{color:"#03911a",fontWeight:"bold"}})})]})}):e.jsxs(e.Fragment,{children:[e.jsx(C,{sx:{color:`${d.palette.colors[11]}`},onClick:()=>Ie(t.row.id),children:"Edit"}),e.jsx(C,{sx:{color:`${d.palette.colors[11]}`},onClick:()=>{f(r=>r.filter(s=>s.id!==t.row.id))},children:"Remove"})]})})}}],Ie=t=>{f(a=>a.map(r=>r.id===t?{...r,isEditSkill:!r.isEditSkill}:r))},ye=t=>{const a=t.target.files[0];if(a){const r=new FileReader;r.onloadend=()=>{const s=r.result.replace("data:","").replace(/^.+,/,"");T(s),P(r.result)},r.readAsDataURL(a)}};c.useEffect(()=>{(async()=>{try{const[a,r]=await Promise.all([w.get("http://52.140.64.177:9090/getAllSkillNames"),w.get("http://52.140.64.177:9090/getIdAndNames")]);fe(a==null?void 0:a.data),je(r==null?void 0:r.data)}catch(a){console.error("Error fetching data",a)}})()},[]),c.useEffect(()=>{v&&(async()=>{var n,i,m,g,V,z,J,Q,X,Z,_,k,ee,te,ae,re,ie,oe,se,ne;const a=await w({method:"get",url:`http://52.140.64.177:9090/UserDetails?emailID=${v}`}),r=[];(i=(n=a==null?void 0:a.data)==null?void 0:n.Zones)==null||i.map(x=>r.push(x==null?void 0:x.ZoneId)),A(r),I({userName:(g=(m=a==null?void 0:a.data)==null?void 0:m.UserDetails)==null?void 0:g.Name,phoneNumber:(z=(V=a==null?void 0:a.data)==null?void 0:V.UserDetails)==null?void 0:z.ContactNumber,emailID:(Q=(J=a==null?void 0:a.data)==null?void 0:J.UserDetails)==null?void 0:Q.EmailId,role:(Z=(X=a==null?void 0:a.data)==null?void 0:X.UserDetails)==null?void 0:Z.Role,zones:r,userID:(k=(_=a==null?void 0:a.data)==null?void 0:_.UserDetails)==null?void 0:k.UserId}),P("data:image/*;base64,"+((te=(ee=a==null?void 0:a.data)==null?void 0:ee.UserDetails)==null?void 0:te.Photo)),T((re=(ae=a==null?void 0:a.data)==null?void 0:ae.UserDetails)==null?void 0:re.Photo),L.current=(oe=(ie=a==null?void 0:a.data)==null?void 0:ie.UserDetails)==null?void 0:oe.userID;let s=[];(ne=(se=a==null?void 0:a.data)==null?void 0:se.Skills)==null||ne.map((x,we)=>{const Ne={id:we,skill:x==null?void 0:x.SkillId,startDate:x==null?void 0:x.StartDate,expiryDate:x==null?void 0:x.ExpiryDate};s.push(Ne)}),f(s)})()},[v]);const Ce=async()=>{var a,r,s,n;N(!0);let t=[];S==null||S.map(i=>{let m={skillId:i==null?void 0:i.skill,startDate:new Date(i==null?void 0:i.startDate).toISOString().split("T")[0],expiryDate:new Date(i==null?void 0:i.expiryDate).toISOString().split("T")[0]};t.push(m)});try{const i=await w({method:"post",url:"http://52.140.64.177:9090/addUsers",data:{userName:o==null?void 0:o.userName,password:"Abc@123",emailID:o==null?void 0:o.emailID,userId:o==null?void 0:o.userID,phoneNumber:o==null?void 0:o.phoneNumber,role:o==null?void 0:o.role,zoneIds:l,skill:t,status:"Active",photo:W}});((r=(a=i==null?void 0:i.data)==null?void 0:a.status)==null?void 0:r.toUpperCase())==="SUCCESS"?(M({open:!0,message:(s=i==null?void 0:i.data)==null?void 0:s.message,severity:"success"}),E("/user-management/registration")):M({open:!0,message:(n=i==null?void 0:i.data)==null?void 0:n.message,severity:"error"})}catch(i){console.error("Error adding user:",i)}finally{N(!1)}},ve=async()=>{var a,r,s,n;N(!0);let t=[];S==null||S.map(i=>{let m={skillId:i==null?void 0:i.skill,startDate:new Date(i==null?void 0:i.startDate).toISOString().split("T")[0],expiryDate:new Date(i==null?void 0:i.expiryDate).toISOString().split("T")[0]};t.push(m)});try{const i=await w({method:"post",url:"http://52.140.64.177:9090/updateUserDetails",data:{userID:L.current,userName:o==null?void 0:o.userName,emailID:o==null?void 0:o.emailID,phoneNumber:o==null?void 0:o.phoneNumber,role:o==null?void 0:o.role,zones:l,skill:t,photo:W}});((r=(a=i==null?void 0:i.data)==null?void 0:a.status)==null?void 0:r.toUpperCase())==="SUCCESS"?(M({open:!0,message:(s=i==null?void 0:i.data)==null?void 0:s.message,severity:"success"}),E("/user-management/registration")):M({open:!0,message:(n=i==null?void 0:i.data)==null?void 0:n.message,severity:"error"})}catch(i){console.error("Error adding user:",i)}finally{N(!1)}};return e.jsxs(u,{sx:{borderRadius:"20px",background:`${d.palette.colors[2]} 0% 0% no-repeat padding-box`,my:2,mr:2,p:2.5,boxShadow:`inset 0px 0px 6px ${d.palette.colors[3]}`,opacity:1,height:"100%"},children:[e.jsx(C,{sx:{color:d.palette.colors[21],fontSize:"14px",fontWeight:600},startIcon:e.jsx(Re,{}),onClick:()=>E(-1),children:"Back"}),e.jsxs(u,{sx:{background:`${d.palette.colors[1]} 0% 0% no-repeat padding-box`,borderRadius:"10px",opacity:1},children:[e.jsx(u,{sx:{py:2,px:2.5},children:e.jsxs(p,{variant:"h4",fontWeight:600,children:[v?"Edit":"Add"," User"]})}),e.jsx(G,{}),e.jsxs(u,{sx:{py:2,px:2.5,"& .MuiTypography-root":{fontSize:"12px",color:d.palette.colors[21]}},children:[De&&e.jsx($e,{}),e.jsxs(h,{container:!0,spacing:3,children:[e.jsxs(h,{size:{xs:12,lg:8},container:!0,spacing:3,children:[e.jsxs(h,{size:6,children:[e.jsx(p,{children:"Name"}),e.jsx(F,{size:"small",fullWidth:!0,value:o.userName,className:"inputFields",onChange:t=>{I({...o,userName:t.target.value})}})]}),e.jsxs(h,{size:6,children:[e.jsx(p,{children:"Contact number"}),e.jsx(F,{size:"small",fullWidth:!0,value:o.phoneNumber,className:"inputFields",onChange:t=>{I({...o,phoneNumber:t.target.value})}})]}),e.jsxs(h,{size:6,children:[e.jsx(p,{children:"Email ID"}),e.jsx(F,{size:"small",fullWidth:!0,value:o.emailID,className:"inputFields",onChange:t=>{I({...o,emailID:t.target.value})},onBlur:t=>{o!=null&&o.userID||I({...o,userID:t.target.value})}})]}),e.jsxs(h,{size:6,children:[e.jsx(p,{children:"User ID"}),e.jsx(F,{size:"small",fullWidth:!0,disabled:!0,value:o.userID,className:"inputFields",onChange:t=>{I({...o,userID:t.target.value})}})]})]}),e.jsxs(h,{size:{xs:12,lg:4},container:!0,direction:"row",sx:{border:`1px dashed ${d.palette.colors[22]}`,borderRadius:"10px",background:"#F5F5F5 0% 0% no-repeat padding-box",opacity:1,px:3},children:[e.jsx(h,{size:4,container:!0,sx:{justifyContent:"center",alignItems:"center",p:2},children:Y?e.jsx(de,{sx:{width:"94px",height:"94px"},src:Y}):e.jsx(de,{sx:{width:"94px",height:"94px"}})}),e.jsxs(h,{size:8,container:!0,direction:"column",spacing:1,sx:{justifyContent:"center",alignItems:"center",direction:"column"},children:[e.jsx(p,{children:"Upload user's profile picture"}),e.jsx(p,{children:"or"}),e.jsxs(C,{component:"label",role:void 0,tabIndex:-1,sx:{fontWeight:500,color:`${d.palette.colors[11]}`,fontSize:14,height:"25px",textDecoration:"underline"},children:[e.jsx(be,{type:"file",accept:"image/*",onChange:ye}),"Browse Gallery"]})]})]})]}),e.jsx(G,{sx:{my:3}}),e.jsxs(h,{container:!0,spacing:3,children:[e.jsxs(h,{size:4,className:"inputFields",children:[e.jsx(p,{children:"Role"}),e.jsxs(B,{value:o==null?void 0:o.role,onChange:t=>{I({...o,role:t.target.value})},sx:{height:"40px",width:"100%"},children:[e.jsx(y,{value:"Admin",children:"Admin"}),e.jsx(y,{value:"Manager",children:"Manager"}),e.jsx(y,{value:"Inspector",children:"Inspector"}),e.jsx(y,{value:"Reviewer",children:"Reviewer"}),e.jsx(y,{value:"Approver",children:"Approver"})]})]}),e.jsxs(h,{size:4,className:"inputFields",children:[e.jsx(p,{children:"Zone"}),e.jsx(B,{multiple:!0,value:l,onChange:t=>{R(!1),A(typeof t.target.value=="string"?t.target.value.split(","):t.target.value)},endAdornment:e.jsx(e.Fragment,{children:(l==null?void 0:l.length)>0&&e.jsx(pe,{sx:{color:"#5F6368",cursor:"pointer",fontSize:"15px",mr:1},onClick:()=>A([])})}),renderValue:t=>e.jsxs(u,{sx:{display:"flex"},children:[e.jsx(u,{sx:{display:"flex",gap:.5,overflow:"hidden"," .MuiChip-root":{height:"26px",borderRadius:"4px"}},children:t==null?void 0:t.map(a=>{var r;return e.jsx(le,{label:(r=D==null?void 0:D.find(s=>(s==null?void 0:s.zoneId)===a))==null?void 0:r.name},a)})}),t.length>2&&e.jsxs(C,{ref:$,sx:{color:`${d.palette.colors[11]}`,size:"small",height:"26px"},onMouseLeave:()=>{R(!1)},onMouseEnter:a=>{R(!0)},children:["+",t.length-2," more"]})]}),sx:{height:"40px",width:"100%"},children:D==null?void 0:D.map(t=>e.jsxs(y,{value:t==null?void 0:t.zoneId,children:[e.jsx(Ge,{checked:l==null?void 0:l.includes(t==null?void 0:t.zoneId)}),e.jsx(Be,{primary:t==null?void 0:t.name})]},t==null?void 0:t.zoneId))}),O&&(l==null?void 0:l.length)>2&&e.jsx(Ye,{sx:{pointerEvents:"none",boxShadow:"0px","& .MuiPaper-root":{boxShadow:"none"}},open:O,anchorReference:"anchorPosition",anchorPosition:{top:((q=$.current)==null?void 0:q.getBoundingClientRect().bottom)+10,left:((K=$.current)==null?void 0:K.getBoundingClientRect().left)-100},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},disableRestoreFocus:!0,children:e.jsx(u,{sx:{p:1," .MuiChip-root":{height:"26px",borderRadius:"4px"},width:"270px",backgroundColor:"#F2F6F6",display:"flex",gap:.5,flexWrap:"wrap"},children:l==null?void 0:l.map(t=>{var a;return e.jsx(le,{label:(a=D==null?void 0:D.find(r=>(r==null?void 0:r.zoneId)===t))==null?void 0:a.name},t)})})})]})]}),e.jsx(G,{sx:{my:3}}),e.jsx(p,{sx:{fontSize:"14px !important",mb:1},children:"Skills"}),e.jsxs(u,{className:"addButtonContainer",onClick:()=>{ge||(f(t=>[{id:t.length,skill:"",startDate:b(Date()),expiryDate:b(Date()),isEditSkill:!0},...t]),U(!0))},children:[e.jsx(We,{sx:{mr:1}}),e.jsx(p,{className:"typographyFontWeight",children:"Add Skills"})]}),e.jsx(u,{sx:{maxHeight:"400px",mt:1,".MuiDataGrid-columnHeader":{backgroundColor:`${d.palette.colors[18]}`},".MuiDataGrid-root":{borderRadius:"10px 10px 0px 0px",border:"0px !important",borderColor:"white !important","--DataGrid-rowBorderColor":"#ffffff"},".MuiDataGrid-main":{borderRadius:"10px 10px 0px 0px"},"& .MuiDataGrid-columnsContainer, .MuiDataGrid-cell":{borderBottom:"0px !important",borderTop:"0px !important"}," .MuiDataGrid-row":{border:`1px solid ${d.palette.colors[22]}`,borderRadius:"6px",my:"1px"}," .MuiDataGrid-overlay":{display:"none"},".MuiDataGrid-columnHeaders .MuiDataGrid-scrollbarFiller":{backgroundColor:`${d.palette.colors[18]}`}," .MuiDataGrid-scrollbar":{display:"none"},".MuiDataGrid-footerContainer":{borderTop:"0px"}},children:e.jsx(Pe,{columns:Se,rows:S,hideFooter:!0})}),e.jsx(u,{sx:{"& .MuiButtonBase-root:hover":{backgroundColor:d.palette.colors[11]},display:"flex",justifyContent:"flex-end",mt:2},children:e.jsx(C,{onClick:()=>v?ve():Ce(),variant:"contained",sx:{backgroundColor:`${d.palette.colors[11]}`,color:"#ffffff",borderRadius:"20px",px:5,height:"40px"},children:"Submit"})})]})]})]})};export{ze as default};

import{b as He,a as Ge,r as l,S as ft,J as jt,j as e,G as h,L as Ct,B as u,T as c,F as Et,h as vt,M as St,N as At,e as D,i as P,z as Nt,D as J,I as Q,m as L,f as Me,A as Be,g as Ve,d as Ce,O as bt,o as F,u as yt,K as wt}from"./index-CsrR-wrF.js";import{A as ce,H as Tt}from"./checklist-DckYB8Ak.js";import{A as Pt,a as Ft}from"./add-notes-m3W-_Glx.js";import{A as _t}from"./PlaylistAddOutlined-CpSMRKtR.js";import{D as Dt}from"./download-DA--uIhM.js";import{C as $e}from"./Check-cGaUIAku.js";import{C as Ye}from"./Close-CoWB75cj.js";import{R as Ue,C as q}from"./CustomRadio-DaMEwieZ.js";import{E as Wt}from"./EditOutlined-CGOMMi2k.js";import{D as Ot}from"./DeleteOutlined-BStDlczd.js";/* empty css                    */const zt=({inspectionChecklists:A,inspectionID:y,inspectorReport:d,approverReport:X,action:N="",groupInspectors:Y=[],caseDetails:j})=>{const W=He(),Z=Ge(),[p,U]=l.useState([]),[K,k]=l.useState({}),[E,v]=l.useState([]),[C,_]=l.useState(""),[R,O]=l.useState(""),[H,w]=l.useState(""),[I,ee]=l.useState(""),f=l.useRef(0),[ie,Ee]=l.useState(""),[z,de]=l.useState(localStorage.getItem("userRole")!=="INSPECTOR"),[S,ue]=l.useState(!1),ve=l.useRef(0),te=l.useRef(0),pe=l.useRef(null),{snack:Mt,setSnack:M}=l.useContext(ft),[Le,b]=l.useState(!1),[me,Se]=l.useState(""),[ge,Ae]=l.useState(""),[i,Ne]=l.useState(null),[xe,he]=l.useState(""),[be,Bt]=l.useState(null),[B,qe]=l.useState(null),[V,ye]=l.useState(null),[Vt,Ke]=l.useState([]),[Re,Ie]=l.useState(""),se=l.useRef([]),[Je,Qe]=l.useState(!1),[we,Te]=l.useState({}),[Xe,Ze]=l.useState([]),[Pe,ne]=l.useState(!1),[Fe,fe]=l.useState(""),re=l.useRef({}),[ke,et]=l.useState(null),[tt,ae]=l.useState(""),rt=jt("input")`
        clip: rect(0 0 0 0);
        clip-path: inset(50%);
        height: 1px;
        overflow: hidden;
        position: absolute;
        bottom: 0;
        left: 0;
        white-space: nowrap;
        width: 1px;
    `;l.useEffect(()=>{pe.current&&(pe.current.scrollTop=0)},[p[f.current]]),l.useEffect(()=>{U(A)},[A]),l.useEffect(()=>{Ee(d)},[d]),l.useEffect(()=>{he(X)},[X]),l.useEffect(()=>{var t,o,n;A==null||A.map(s=>{var a;ve.current+=(a=s==null?void 0:s.checklistItem)==null?void 0:a.length}),k(A[0]),v((t=A[0])==null?void 0:t.checklistItem),_((o=A[0])==null?void 0:o.categoryName),ae((n=A[0])==null?void 0:n.inspectorID)},[A]),l.useEffect(()=>{Ke([])},[K]);const _e=()=>{var t,o,n,s,a,r,x;E.length>0&&U(T=>T.map(g=>(g==null?void 0:g.categoryName)===C?{...g,checklistItem:E,approverComment:me,reviewerComment:ge}:g)),de(!1),ue(!1),k(p[f.current]),v((t=p[f.current])==null?void 0:t.checklistItem),_((o=p[f.current])==null?void 0:o.categoryName),ae((n=p[f.current])==null?void 0:n.inspectorID),Se((s=p[f.current])!=null&&s.approverComment?(a=p[f.current])==null?void 0:a.approverComment:""),Ae((r=p[f.current])!=null&&r.reviewerComment?(x=p[f.current])==null?void 0:x.reviewerComment:""),w(""),ee(""),se.current[f.current]&&se.current[f.current].focus()},ot=t=>{ae(t),U(o=>o.map(n=>(n==null?void 0:n.categoryName)===C?{...n,inspectorID:t}:n))},je=()=>{U(t=>t.map(o=>(o==null?void 0:o.categoryName)===C?{...o,checklistItem:E}:o)),k({}),v([]),_(""),ae(""),w(""),ee(""),de(!0),ue(!1)},oe=()=>{U(t=>t.map(o=>(o==null?void 0:o.categoryName)===C?{...o,checklistItem:E,approverComment:me,reviewerComment:ge}:o)),ue(!0),de(!1)},st=async(t,o)=>{const n=await nt(t);v(s=>s.map(a=>{var r,x;return a.checklist_name===o.checklist_name?{...a,attachments:((r=a.attachments)==null?void 0:r.length)>0?[...a.attachments,t.target.files[0]]:[t.target.files[0]],attachmentsBase64:((x=a.attachmentsBase64)==null?void 0:x.length)>0?[...a.attachmentsBase64,n]:[n]}:a}))},nt=async t=>new Promise((o,n)=>{const s=t.target.files[0];if(s){const a=new FileReader;a.onloadend=()=>{const r=a.result.replace("data:","").replace(/^.+,/,"");o(r)},a.onerror=r=>n(r),a.readAsDataURL(s)}else n("No file selected")}),at=(t,o)=>{v(n=>n.map(s=>s.checklist_name===o.checklist_name?{...s,comment:t.target.value}:s))},lt=t=>{v(o=>o.map(n=>{var s;return n.checklist_name===t.checklist_name?{...n,selected_corrective_action:((s=n.selected_corrective_action)==null?void 0:s.length)>0?[...n.selected_corrective_action,R]:[R]}:n})),ee(""),O("")},ct=(t,o)=>{v(n=>n.map(s=>{var a;return s.checklist_name===t.checklist_name?{...s,selected_corrective_action:(a=s.selected_corrective_action)==null?void 0:a.map(r=>r===o?Fe:r)}:s})),ne(!1),fe("")},it=(t,o)=>{v(n=>n.map(s=>{var a;return s.checklist_name===t.checklist_name?{...s,selected_corrective_action:(a=s.selected_corrective_action)==null?void 0:a.filter(r=>r!==o)}:s}))},dt=(t,o)=>{v(n=>n.map(s=>s.checklist_name===t.checklist_name?{...s,selected_answer:o}:s)),re.current[C]?re.current[C].includes(t==null?void 0:t.checklist_id)||(re.current[C].push(t==null?void 0:t.checklist_id),te.current=parseInt(te.current)+1):(re.current[C]=[t==null?void 0:t.checklist_id],te.current=parseInt(te.current)+1)},ut=t=>{if(typeof t=="string"){const n=t.match(/^data:image\/(png|jpeg|jpg|gif|webp|bmp|svg\+xml);base64,/),s=n?`image/${n[1]}`:"image/png",a=t.replace(/^data:image\/(png|jpeg|jpg|gif|webp|bmp|svg\+xml);base64,/,""),r=atob(a),x=new Uint8Array(r.length);for(let g=0;g<r.length;g++)x[g]=r.charCodeAt(g);const T=new Blob([x],{type:s});return URL.createObjectURL(T)}return URL.createObjectURL(t)},De=async()=>{var t;try{b(!0);let o=[];p==null||p.forEach(s=>{var a;(s==null?void 0:s.categoryName)===C?E==null||E.forEach(r=>{var x;o.push({id:{inspectionID:y,categoryID:s==null?void 0:s.categoryId,checklistID:r==null?void 0:r.checklist_id},selected_answer:r==null?void 0:r.selected_answer,attachment:(r==null?void 0:r.attachmentsBase64)||null,comment:(x=r==null?void 0:r.comment)==null?void 0:x.trim(),corrective_actions:(r==null?void 0:r.selected_corrective_action)||[]})}):(a=s==null?void 0:s.checklistItem)==null||a.forEach(r=>{var x;o.push({id:{inspectionID:y,categoryID:s==null?void 0:s.categoryId,checklistID:r==null?void 0:r.checklist_id},selected_answer:r==null?void 0:r.selected_answer,attachment:(r==null?void 0:r.attachmentsBase64)||null,comment:(x=r==null?void 0:r.comment)==null?void 0:x.trim(),corrective_actions:(r==null?void 0:r.selected_corrective_action)||[]})})});const n=await F({method:"post",url:"http://52.140.64.177:9090/saveInspection",data:{inspectionChecklistandAnswers:o,inspectorComment:ie}});((t=n==null?void 0:n.data)==null?void 0:t.status)==="Failure"?M({open:!0,message:"Something went wrong. Please try again.",severity:"error"}):M({open:!0,message:"Inspection saved successfully.",severity:"success"}),b(!1)}catch(o){console.log(o),b(!1),M({open:!0,message:"An error occurred while saving the inspection.",severity:"error"})}},We=async()=>{var t;try{b(!0);let o=[];p==null||p.map(s=>{var a;(a=s==null?void 0:s.checklistItem)==null||a.map(r=>{var x,T;o.push({id:{inspectionID:y,categoryID:s==null?void 0:s.categoryId,checklistID:r==null?void 0:r.checklist_id},selected_answer:r==null?void 0:r.selected_answer,attachment:(r==null?void 0:r.attachmentsBase64)||null,comment:(x=r==null?void 0:r.comment)==null?void 0:x.trim(),corrective_actions:((T=r==null?void 0:r.selected_corrective_action)==null?void 0:T.filter(g=>g!==""))||[]})})});const n=await F({method:"post",url:`http://52.140.64.177:9090/submitInspection/${y}`,data:{inspectionChecklistandAnswers:o,inspectorComment:ie}});((t=n==null?void 0:n.data)==null?void 0:t.status)==="Failure"?M({open:!0,message:"Something went wrong. Please try again later.",severity:"error"}):(M({open:!0,message:"Inspection submitted successfully.",severity:"success"}),Z("/cases")),b(!1)}catch(o){console.log(o),b(!1)}},$=async(t,o,n,s)=>{try{b(!0);const a=[];p==null||p.map(g=>{a.push({id:{inspectionID:y,categoryID:g==null?void 0:g.categoryId},approverComment:g==null?void 0:g.approverComment,reviewerComment:g==null?void 0:g.reviewerComment})});const r=localStorage.getItem("userRole");let x="review";r==="DEPARTMENT DIRECTOR"?x="approver":(r==="REVIEWER"||r==="DEPARTMENT HEAD"||r==="APPROVER")&&(x="review");const T=await F({method:"post",url:"http://52.140.64.177:9090/reviewInspection",data:{inspectionId:y,inspectionStage:x,approverReviewerComments:a,overallComment:xe,action:t,recommendedAction:o,dateOfFollowUp:n,dateOfReinspection:s,reviewLabel:r==="REVIEWER"?1:r==="APPROVER"?2:r==="DEPARTMENT HEAD"?3:0}});t==="save"&&M({open:!0,message:"Saved Inspection Approval.",severity:"success"}),t==="submit"&&(M({open:!0,message:"Inspection Approved Successfully.",severity:"success"}),Z("/cases")),b(!1)}catch(a){b(!1),console.log("Error during review submission:",a),M({open:!0,message:"Something went wrong. Please try again later.",severity:"error"})}},pt=async t=>{try{b(!0);const o=await F.post("http://52.140.64.177:9090/askCopilot",{prompt:we[t]||""});o.data.status==="SUCCESS"?Ie(n=>({...n,[t]:o.data.chatGPTResponse})):Ie(n=>({...n,[t]:"Error: Unable to fetch data"})),b(!1)}catch(o){b(!1),console.error("Error fetching data from API:",o),Ie(n=>({...n,[t]:"Error: Unable to fetch data"}))}},mt=(t,o)=>{Te(n=>({...n,[o]:t.target.value}))},gt=t=>{pt(t)},xt=t=>{Te(o=>({...o,[t]:""}))},ht=(t,o)=>{t.preventDefault(),v(n=>n.map(s=>s.checklist_name===o.checklist_name?{...s,comment:Re[o.checklist_id]}:s))},Rt=()=>{Qe(!0),se.current[f.current].click()},It=(t,o)=>{const n=t.target.checked;Ze(s=>n?[...s,o]:s.filter(a=>a!==o))},Oe=async t=>{try{let o=[];p==null||p.forEach(a=>{o.push({assignTo:a==null?void 0:a.inspectorID,checklistCatId:a==null?void 0:a.categoryId})});const n=t==="save"?`http://52.140.64.177:9090/assignCategory/${y}/Save`:`http://52.140.64.177:9090/assignCategory/${y}/Submit`,s=await F.post(n,o);console.log(s),s.status===200&&(console.log("Categories assigned successfully:",s.data),t==="submit"&&Z("/cases"))}catch(o){console.log(o)}};return e.jsx(e.Fragment,{children:e.jsxs(h,{container:!0,sx:{m:2.5},spacing:2.5,children:[Le&&e.jsx(Ct,{}),e.jsxs(h,{size:3,className:"categoryContainer",children:[(localStorage.getItem("userRole")==="REVIEWER"||localStorage.getItem("userRole")==="APPROVER"||localStorage.getItem("userRole")==="DEPARTMENT HEAD"||localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR")&&e.jsxs(u,{className:"inspectionReportItem",sx:{backgroundColor:z?W.palette.colors[20]:""},onClick:je,children:[e.jsx(ce,{sx:{fontSize:30}}),e.jsx(c,{className:"typographyFontWeight",children:"Inspection Report"})]}),e.jsxs(u,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(u,{display:"flex",alignItems:"center",children:[e.jsx(ce,{sx:{fontSize:30}}),e.jsx(c,{className:"typographyFontWeight",children:"Categories"})]}),localStorage.getItem("userRole")==="INSPECTOR"&&e.jsx(u,{display:"flex",pr:2,children:e.jsxs(c,{className:"typographyFontWeight",children:[te.current,"/",ve.current]})})]}),e.jsx(u,{children:p==null?void 0:p.map((t,o)=>{var n;return e.jsxs(u,{className:"categoryItems",tabIndex:0,ref:s=>se.current[o]=s,sx:{backgroundColor:!z&&!S&&(t==null?void 0:t.categoryId)===(K==null?void 0:K.categoryId)?W.palette.colors[20]:""},onClick:()=>{f.current=o,_e()},children:[e.jsx(c,{className:"typographyFontWeight",children:t.categoryName.length>25?t.categoryName.slice(0,24)+"...":t.categoryName}),localStorage.getItem("userRole")==="INSPECTOR"&&e.jsxs(c,{className:"typographyFontWeight",children:[(n=re.current[t.categoryName])==null?void 0:n.length,"/",t.checklistItem.length]})]},o)})}),N!=="assign"&&localStorage.getItem("userRole")==="INSPECTOR"&&e.jsxs(u,{className:"inspectionReportItem",sx:{backgroundColor:z?W.palette.colors[20]:""},onClick:je,children:[e.jsx(ce,{sx:{fontSize:30}}),e.jsx(c,{className:"typographyFontWeight",children:"Inspection Report"})]}),(localStorage.getItem("userRole")==="APPROVER"||localStorage.getItem("userRole")==="REVIEWER"||localStorage.getItem("userRole")==="DEPARTMENT HEAD"||localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR")&&e.jsxs(u,{className:"inspectionReportItem",sx:{backgroundColor:S?W.palette.colors[20]:""},onClick:oe,children:[e.jsx(ce,{sx:{fontSize:30}}),e.jsx(c,{className:"typographyFontWeight",children:"Recommended Actions"})]})]}),e.jsxs(h,{size:9,container:!0,className:"checklistContainer",ref:pe,children:[!z&&!S&&e.jsxs(e.Fragment,{children:[N&&(N==="assign"||N==="review")&&e.jsxs(h,{container:!0,size:12,sx:{justifyContent:"space-between",backgroundColor:"#E6EFF0",borderRadius:"10px",alignItems:"center",px:2,py:.5},children:[e.jsx(c,{children:C}),e.jsx(Et,{className:"newCaseFields",sx:{width:"200px"},children:e.jsx(vt,{value:tt,onChange:t=>ot(t.target.value),disabled:N==="review",children:Y==null?void 0:Y.map(t=>e.jsx(St,{value:t==null?void 0:t.emailID,children:t==null?void 0:t.userName},t==null?void 0:t.emailID))})})]}),e.jsx(h,{container:!0,size:12,className:"categoryChecklistContainer",children:E==null?void 0:E.map((t,o)=>{var n,s,a,r,x,T,g;return e.jsxs(e.Fragment,{children:[e.jsxs(h,{container:!0,rowGap:2,sx:{mb:2,mt:4},children:[e.jsxs(h,{container:!0,sx:{alignItems:"center"},children:[e.jsx(h,{container:!0,children:Je&&e.jsx(At,{checked:Xe.includes(t.checklist_id),onChange:m=>It(m,t.checklist_id)})}),e.jsx(h,{container:!0,children:e.jsx(c,{className:"typographyFontWeight",children:t.checklist_name})})]},t.checklist_id),e.jsx(h,{container:!0,size:12,sx:{columnGap:3,justifyContent:"space-between"},children:(s=(n=t==null?void 0:t.pre_defined_answer_type)==null?void 0:n.split("/"))==null?void 0:s.map((m,G)=>e.jsx(D,{variant:"outlined",className:"choiceButton",disabled:localStorage.getItem("userRole")!=="INSPECTOR",sx:{backgroundColor:(t==null?void 0:t.selected_answer)===m?W.palette.colors[20]:"",fontWeight:(t==null?void 0:t.answer)===m?700:""},onClick:()=>dt(t,m),children:m},m+G))})]},t.checklist_id),localStorage.getItem("userRole")==="INSPECTOR"&&e.jsxs(h,{container:!0,size:12,direction:"column",children:[e.jsx(c,{className:"typographyFontWeight",children:"Co-Pilot"}),e.jsx(P,{placeholder:"Ask Anything",size:"small",className:"multilineInput",value:we[t.checklist_id]||"",onChange:m=>mt(m,t.checklist_id),fullWidth:!0}),e.jsxs(u,{sx:{display:"flex",justifyContent:"flex-end",gap:1,".MuiButtonBase-root":{border:"1px solid #EBEBEB",backgroundColor:"#EBEBEB",borderRadius:"6px",color:"#00060A",px:3}},children:[e.jsx(D,{onClick:()=>xt(t.checklist_id),children:"Clear"}),e.jsx(D,{onClick:()=>gt(t.checklist_id),children:"Ask Co-Pilot"})]}),e.jsx(c,{className:"typographyFontWeight",children:"Answer"}),e.jsx(P,{placeholder:"Answer",size:"small",className:"multilineInput",value:Re[t.checklist_id]||"",slotProps:{input:{readOnly:!0}},fullWidth:!0,multiline:!0,rows:4}),Re[t.checklist_id]&&e.jsx(u,{sx:{textAlign:"right",marginTop:"-10px",padding:"8px 0",position:"relative",top:"0",right:"14px"},children:e.jsx(Nt,{href:"#",onClick:m=>{w(`note${t.checklist_id}`),ht(m,t)},sx:{color:"blue"},children:"Add to Notes"})})]}),e.jsx(J,{sx:{my:1,width:"100%"}}),e.jsxs(e.Fragment,{children:[localStorage.getItem("userRole")==="INSPECTOR"&&e.jsxs(u,{display:"flex",columnGap:3,mr:3,children:[e.jsx(u,{className:"attchmentsContainer",children:e.jsxs(D,{component:"label",role:void 0,tabIndex:-1,sx:{fontWeight:500,color:"black",fontSize:14,height:"25px"},startIcon:e.jsx(Pt,{sx:{fontSize:12}}),children:[e.jsx(rt,{type:"file",accept:"image/*",onChange:m=>{st(m,t)}}),"Attach Image"]})}),e.jsxs(u,{className:"attchmentsContainer",onClick:()=>w(`note${t.checklist_id}`),children:[e.jsx("img",{src:Ft,alt:"Add notes"}),e.jsx(c,{ml:1,className:"typographyFontWeight",children:"Add Notes"})]})]}),e.jsxs(u,{className:"attchmentsContainer",onClick:()=>{ne(!1),ee(`correctiveAction${t.checklist_id}`)},children:[e.jsx(_t,{sx:{mr:1}}),e.jsx(c,{className:"typographyFontWeight",children:"Add Corrective Actions"})]}),e.jsx(J,{sx:{my:1,width:"100%"}})]}),((a=t==null?void 0:t.attachments)==null?void 0:a.length)>0&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{children:[e.jsx(c,{className:"headingFontWeight",children:"Documents"}),e.jsx(u,{className:"attachmentContainer",children:(r=t==null?void 0:t.attachments)==null?void 0:r.map((m,G)=>{var le,ze;return e.jsxs(u,{className:"attachmentItem",children:[e.jsxs(u,{className:"imageContainer",children:[e.jsx("img",{src:ut(m),alt:m.name,className:"attchmentImage"}),e.jsx(c,{className:"attachmentTextStyle",children:((le=m.name)==null?void 0:le.length)>10?((ze=m.name)==null?void 0:ze.slice(0,9))+"...":m.name})]}),e.jsx(u,{className:"imageDownload",children:e.jsx("img",{src:Dt,alt:"Download"})})]},G)})})]}),e.jsx(J,{sx:{my:1,width:"100%"}})]}),((t==null?void 0:t.comment)||H===`note${t.checklist_id}`)&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{width:"100%",children:[e.jsx(c,{className:"headingFontWeight",children:"Note"}),e.jsx(P,{size:"small",fullWidth:!0,disabled:localStorage.getItem("userRole")!=="INSPECTOR",rows:2,className:"multilineInput",multiline:!0,value:t==null?void 0:t.comment,onChange:m=>at(m,t)})]}),e.jsx(J,{sx:{my:1,width:"100%"}})]}),I===`correctiveAction${t.checklist_id}`&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{width:"100%",children:[e.jsx(c,{className:"headingFontWeight",children:"Corrective Actions"}),e.jsx(u,{className:"correctiveActionContainer",children:e.jsx(P,{size:"small",fullWidth:!0,className:"correctiveActionField",value:R,onChange:m=>O(m.target.value)})}),e.jsxs(u,{className:"iconContainer",children:[e.jsx(Q,{onClick:()=>ee(""),children:e.jsx(Ye,{sx:{color:"#d54b4b",fontWeight:"bold"}})}),e.jsx(Q,{onClick:()=>{lt(t)},children:e.jsx($e,{sx:{color:"#03911a",fontWeight:"bold"}})})]})]}),e.jsx(J,{sx:{mt:1,mb:3,width:"100%"}})]}),((T=(x=t.selected_corrective_action)==null?void 0:x.filter(m=>m!==""))==null?void 0:T.length)>0&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{width:"100%",children:[e.jsx(c,{className:"headingFontWeight",children:"Corrective Actions"}),(g=t.selected_corrective_action)==null?void 0:g.map((m,G)=>m&&e.jsx(u,{className:"correctiveActions",children:Pe&&G===ke?e.jsxs(u,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:[e.jsx(P,{size:"small",fullWidth:!0,className:"correctiveActionField",value:Fe,onChange:le=>fe(le.target.value)}),e.jsxs(u,{className:"iconContainer",children:[e.jsx(Q,{onClick:()=>ne(!1),children:e.jsx(Ye,{sx:{color:"#d54b4b",fontWeight:"bold"}})}),e.jsx(Q,{onClick:()=>{ct(t,m)},children:e.jsx($e,{sx:{color:"#03911a",fontWeight:"bold"}})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{className:"typographyFontWeight",children:m}),e.jsxs(u,{children:[e.jsx(Q,{onClick:()=>{Pe||(et(G),ne(!0),fe(m))},children:e.jsx(Wt,{sx:{color:"#03911a",fontWeight:"bold"}})}),e.jsx(Q,{onClick:()=>it(t,m),children:e.jsx(Ot,{sx:{color:"#d54b4b",fontWeight:"bold"}})})]})]})},G))]}),e.jsx(J,{sx:{mt:1,mb:3,width:"100%"}})]})]})})}),(localStorage.getItem("userRole")==="REVIEWER"||localStorage.getItem("userRole")==="APPROVER"||localStorage.getItem("userRole")==="DEPARTMENT HEAD"||localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR")&&e.jsxs(h,{container:!0,size:12,sx:{mt:2},children:[e.jsx(c,{className:"headingFontWeight",variant:"h5",children:"Reviewer's Comments"}),e.jsx(P,{size:"small",fullWidth:!0,rows:3,disabled:localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR",className:"multilineInput",multiline:!0,value:ge,onChange:t=>Ae(t.target.value)})]}),localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR"&&e.jsxs(h,{container:!0,size:12,sx:{mt:2},children:[e.jsx(c,{className:"headingFontWeight",variant:"h5",children:"Approver's Report"}),e.jsx(P,{size:"small",fullWidth:!0,rows:3,className:"multilineInput",multiline:!0,value:me,onChange:t=>Se(t.target.value)})]})]}),z&&e.jsxs(h,{size:12,container:!0,direction:"column",children:[e.jsx(c,{className:"headingFontWeight",variant:"h5",children:"Inspection Report"}),e.jsx(P,{size:"small",fullWidth:!0,disabled:localStorage.getItem("userRole")!=="INSPECTOR",rows:3,className:"multilineInput",multiline:!0,value:ie,onChange:t=>Ee(t.target.value)})]}),S&&localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR"&&e.jsxs(h,{container:!0,size:12,direction:"column",className:"recommendedActionsContainer",children:[e.jsx(c,{className:"headingFontWeight",variant:"h5",children:"Recommended Actions"}),e.jsx(h,{container:!0,size:12,children:e.jsxs(Ue,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"female",name:"radio-buttons-group",value:i,onChange:t=>Ne(t.target.value),sx:{width:"100%"},children:[e.jsx(u,{sx:{border:i==="No Action"?"2px solid #4C8B92":"1px solid #CCCCCC",borderRadius:"6px",opacity:1,px:2,py:1,mb:2},children:e.jsx(L,{value:"No Action",control:e.jsx(q,{sx:{mr:1}}),label:e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h6",color:i==="No Action"?"#4C8B92":"#00060A",children:"No Action Required"}),e.jsx(c,{fontSize:"12px",color:"#6A6969",children:"No action required, Inspection has been completed successfully."})]})})}),e.jsx(u,{sx:{border:i==="Follow Up"?"2px solid #4C8B92":"1px solid #CCCCCC",borderRadius:"6px",opacity:1,px:2,py:1,mb:2},children:e.jsx(L,{value:"Follow Up",control:e.jsx(q,{sx:{mr:1}}),label:e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h6",color:i==="Follow Up"?"#4C8B92":"#00060A",children:"Follow Up Required"}),e.jsx(c,{fontSize:"12px",color:"#6A6969",children:"Follow up required, please select a date for follow up and complete the case."})]})})}),e.jsx(u,{sx:{border:i==="Re-Inspection"?"2px solid #4C8B92":"1px solid #CCCCCC",borderRadius:"6px",opacity:1,px:2,py:1},children:e.jsx(L,{value:"Re-Inspection",control:e.jsx(q,{sx:{mr:1}}),label:e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h6",color:i==="Re-Inspection"?"#4C8B92":"#00060A",children:"Re-Inspection Required"}),e.jsx(c,{fontSize:"12px",color:"#6A6969",children:"Re-Inspection required, please select a date for re-inspection and complete the case."})]})})})]})}),(i==="Follow Up"||i==="Re-Inspection")&&e.jsxs(h,{container:!0,size:12,spacing:0,direction:"column",sx:{mb:1},children:[e.jsx(c,{variant:"h6",children:i==="Follow Up"?"Follow Up Date":"Re Inspection Date"}),e.jsx(Me,{dateAdapter:Be,localeText:{fieldDayPlaceholder:()=>"DD",fieldMonthPlaceholder:()=>"MMM",fieldYearPlaceholder:()=>"YYYY"},children:e.jsx(Ve,{size:"small",value:be,onChange:t=>i==="Follow Up"?qe(Ce(t).format("YYYY-MM-DD")):i==="Re-Inspection"?ye(Ce(t).format("YYYY-MM-DD")):"",format:"DD MMM YYYY",className:"dateField",sx:{height:"40px",width:"370px"},required:!0})})]}),i&&e.jsx(e.Fragment,{children:e.jsxs(h,{container:!0,size:12,sx:{marginBottom:"10px"},children:[e.jsx(c,{className:"headingFontWeight",variant:"h5",children:"Inspection Summary Report"}),e.jsx(P,{size:"small",fullWidth:!0,rows:3,className:"multilineInput",multiline:!0,value:xe,onChange:t=>he(t.target.value)})]})})]}),S&&(localStorage.getItem("userRole")==="REVIEWER"||localStorage.getItem("userRole")==="DEPARTMENT HEAD"||localStorage.getItem("userRole")==="APPROVER")&&e.jsxs(h,{container:!0,size:12,direction:"column",className:"recommendedActionsContainer",children:[e.jsx(c,{className:"headingFontWeight",variant:"h5",children:"Recommended Actions"}),e.jsx(h,{container:!0,size:12,children:e.jsxs(Ue,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"female",name:"radio-buttons-group",value:i,onChange:t=>Ne(t.target.value),sx:{width:"100%"},children:[e.jsx(u,{sx:{border:i==="Pass"?"2px solid #4C8B92":"1px solid #CCCCCC",borderRadius:"6px",opacity:1,px:2,py:1,mb:2},children:e.jsx(L,{value:"Pass",control:e.jsx(q,{sx:{mr:1}}),label:e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h6",color:i==="Pass"?"#4C8B92":"#00060A",children:"Pass"}),e.jsx(c,{fontSize:"12px",color:"#6A6969",children:"Passed at reviewer stage and will be sent to Approver"})]})})}),e.jsxs(u,{sx:{border:i==="Fail"||i==="Redo"||i==="Re-Inspection"?"2px solid #4C8B92":"1px solid #CCCCCC",borderRadius:"6px",opacity:1,px:2,py:1,mb:2},children:[e.jsx(L,{value:"Fail",control:e.jsx(q,{sx:{mr:1}}),label:e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h6",color:i==="Fail"?"#4C8B92":"#00060A",children:"Fail"}),e.jsx(c,{fontSize:"12px",color:"#6A6969",children:"Please select the next step from following and complete the case"})]})}),(i==="Fail"||i==="Redo"||i==="Re-Inspection")&&e.jsxs(e.Fragment,{children:[e.jsx(u,{sx:{border:i==="Redo"?"2px solid #4C8B92":"1px solid #CCCCCC",borderRadius:"6px",opacity:1,px:2,py:1,mb:2,mt:3,mx:2},children:e.jsx(L,{value:"Redo",control:e.jsx(q,{sx:{mr:1}}),label:e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h6",color:i==="Redo"?"#4C8B92":"#00060A",children:"Redo"}),e.jsxs(c,{fontSize:"12px",color:"#6A6969",children:["Please select checklist items needed for redo and send the case back to inspector"," "]})]})})}),e.jsx(u,{sx:{border:i==="Re-Inspection"?"2px solid #4C8B92":"1px solid #CCCCCC",borderRadius:"6px",opacity:1,px:2,py:1,mb:2,mx:2},children:e.jsx(L,{value:"Re-Inspection",control:e.jsx(q,{sx:{mr:1}}),label:e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"h6",color:i==="Re-Inspection"?"#4C8B92":"#00060A",children:"Re-Inspection Required"}),e.jsxs(c,{fontSize:"12px",color:"#6A6969",children:["Re-Inspection required,please select a date for re-inspection and complete the case"," "]})]})})})]})]})]})}),i==="Re-Inspection"&&e.jsxs(h,{container:!0,size:12,direction:"column",sx:{mb:3},children:[e.jsxs(c,{variant:"h6",className:"headingFontWeight",children:["Re Inspection Required"," "]}),e.jsx(Me,{dateAdapter:Be,localeText:{fieldDayPlaceholder:()=>"Choose date",fieldMonthPlaceholder:()=>"",fieldYearPlaceholder:()=>""},children:e.jsx(Ve,{size:"small",value:be,onChange:t=>ye(Ce(t).format("YYYY-MM-DD")),format:"DD MMM YYYY",className:"dateField",sx:{height:"40px",width:"370px"},required:!0})})]}),i==="Redo"&&e.jsxs(D,{sx:{border:"2px dashed #CCCCCC",borderRadius:"6px",padding:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#F8F9FA",width:"100%",textAlign:"left",textTransform:"none",mb:2},onClick:Rt,children:[e.jsxs(u,{sx:{display:"flex",gap:"15px"},children:[e.jsx(u,{children:e.jsx(bt,{fontSize:"large",sx:{color:"grey"}})}),e.jsxs(u,{children:[e.jsx(c,{variant:"h6",sx:{fontSize:"14px",color:"#6A6969"},children:"Select Checklist for Redo"}),e.jsx(c,{sx:{fontSize:"12px",color:"#6A6969"},children:'Checklist selected will be marked for "Redo" when Inspector reopens the case'})]})]}),e.jsx(u,{sx:{display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"4px",backgroundColor:"#E1F5F8",padding:"4px 16px",fontSize:"16px",color:"#4C8B92"},children:"4/24 Selected"})]}),(i==="Pass"||i==="Redo"||i==="Re-Inspection")&&e.jsx(e.Fragment,{children:e.jsxs(h,{container:!0,size:12,sx:{marginBottom:"10px"},children:[e.jsx(c,{className:"headingFontWeight",variant:"h5",children:"Inspection Summary Report"}),e.jsx(P,{size:"small",fullWidth:!0,rows:3,className:"multilineInput",multiline:!0,value:xe,onChange:t=>he(t.target.value)})]})})]}),e.jsxs(h,{container:!0,size:12,columnGap:3,sx:{justifyContent:"flex-end"},children:[e.jsx(D,{variant:"outlined",className:"saveButton",onClick:()=>{localStorage.getItem("userRole")==="INSPECTOR"&&(N==="assign"?Oe("save"):De()),localStorage.getItem("userRole")==="APPROVER"&&$("save",i,B,V),localStorage.getItem("userRole")==="REVIEWER"&&$("save",i,B,V),localStorage.getItem("userRole")==="DEPARTMENT HEAD"&&$("save",i,B,V),localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR"&&$("save",i,B,V)},children:"Save"}),(localStorage.getItem("userRole")==="INSPECTOR"&&!z||localStorage.getItem("userRole")==="APPROVER"&&!S||localStorage.getItem("userRole")==="REVIEWER"&&!S||localStorage.getItem("userRole")==="DEPARTMENT HEAD"&&!S||localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR"&&!S)&&e.jsx(D,{className:"nextSubmitButton",disabled:N==="assign"&&f.current===(p==null?void 0:p.length)-1,onClick:()=>{f.current<(p==null?void 0:p.length)-1?(z?f.current=0:f.current=f.current+1,_e()):localStorage.getItem("userRole")==="INSPECTOR"?N==="assign"?Oe("submit"):je():(localStorage.getItem("userRole")==="APPROVER"||localStorage.getItem("userRole")==="REVIEWER"||localStorage.getItem("userRole")==="DEPARTMENT HEAD"||localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR")&&oe()},children:localStorage.getItem("userRole")==="INSPECTOR"&&N==="assign"?"Submit":"Next"}),(localStorage.getItem("userRole")==="INSPECTOR"&&z||localStorage.getItem("userRole")==="APPROVER"&&S||localStorage.getItem("userRole")==="REVIEWER"&&S||localStorage.getItem("userRole")==="DEPARTMENT HEAD"&&S||localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR"&&S)&&e.jsx(D,{className:"nextSubmitButton",onClick:()=>{localStorage.getItem("userRole")==="INSPECTOR"&&((j==null?void 0:j.caseCreationType)==="individual"||N==="review"&&((j==null?void 0:j.caseCreationType)==="group"||(j==null?void 0:j.caseCreationType)==="plan")&&(j==null?void 0:j.leadId)===parseInt(localStorage.getItem("userID"))?We():De()),localStorage.getItem("userRole")==="APPROVER"&&$("submit",i,B,V),localStorage.getItem("userRole")==="REVIEWER"&&$("submit",i,B,V),localStorage.getItem("userRole")==="DEPARTMENT HEAD"&&$("submit",i,B,V),localStorage.getItem("userRole")==="DEPARTMENT DIRECTOR"&&$("submit",i,B,V)},sx:{backgroundColor:localStorage.getItem("userRole")==="REVIEWER"&&!i?"grey !important":"",color:localStorage.getItem("userRole")==="REVIEWER"&&!i?"white !important":""},disabled:localStorage.getItem("userRole")==="REVIEWER"&&!i,children:"Submit"})]})]})]})})},Zt=()=>{var E,v;const A=He(),y=yt(),d=(E=y.state)==null?void 0:E.caseDetails,X=(v=y.state)==null?void 0:v.action,[N,Y]=l.useState([]),[j,W]=l.useState(""),[Z,p]=l.useState(""),U=Ge(),[K,k]=l.useState([]);return l.useEffect(()=>{const C=async()=>{var O,H,w;const R=!X&&((d==null?void 0:d.caseCreationType)==="plan"||(d==null?void 0:d.caseCreationType)==="group")?await F({method:"get",url:`http://52.140.64.177:9090/getSubmittedInspection/${d==null?void 0:d.inspectionID}?inspectorId=${localStorage.getItem("userEmail")}`}):await F({method:"get",url:`http://52.140.64.177:9090/getSubmittedInspection/${d==null?void 0:d.inspectionID}`});if(((O=Object.keys(R==null?void 0:R.data))==null?void 0:O.length)>0)Y((H=R==null?void 0:R.data)==null?void 0:H.checklist),W((w=R==null?void 0:R.data)==null?void 0:w.inspectorComment);else{const I=await F({method:"get",url:`http://52.140.64.177:9090/getInspectionChecklist/${d==null?void 0:d.inspectionID}`});Y(I==null?void 0:I.data)}},_=async()=>{var R,O,H,w;try{const I=await F({method:"get",url:`http://52.140.64.177:9090/getSubmittedInspection/${d==null?void 0:d.inspectionID}`});Y((R=I==null?void 0:I.data)==null?void 0:R.checklist),W(((O=I==null?void 0:I.data)==null?void 0:O.reviewerComment)||((H=I==null?void 0:I.data)==null?void 0:H.inspectorComment)),p((w=I==null?void 0:I.data)==null?void 0:w.approverComment)}catch(I){console.error("Error fetching submitted inspection checklist:",I)}};if(d!=null&&d.inspectionID){const R=localStorage.getItem("userRole");R==="INSPECTOR"&&C(),(R==="APPROVER"||R==="REVIEWER"||R==="DEPARTMENT HEAD"||R==="DEPARTMENT DIRECTOR")&&_()}},[d==null?void 0:d.inspectionID]),l.useEffect(()=>{const C=async()=>{const _=await F.get(`http://52.140.64.177:9090/getUsersByGroupId/${d==null?void 0:d.groupId}`);k(_==null?void 0:_.data)};d!=null&&d.groupId&&C()},[d==null?void 0:d.groupId]),e.jsx(e.Fragment,{children:e.jsxs(u,{className:"inspectionContainer",children:[e.jsx(D,{className:"backButton",startIcon:e.jsx(wt,{}),onClick:()=>U(-1),children:"Back"}),e.jsxs(u,{display:"flex",flexDirection:"column",sx:{borderRadius:"10px",background:`${A.palette.colors[1]} 0% 0% no-repeat padding-box`,mt:1},children:[e.jsx(Tt,{caseDetails:d}),e.jsx(zt,{inspectionChecklists:N,inspectionID:d==null?void 0:d.inspectionID,inspectorReport:j,approverReport:Z,action:X,groupInspectors:K,caseDetails:d})]})]})})};export{Zt as default};

import{b as D,a as L,u as O,r as a,S as W,R as U,j as s,B as l,T as y,e as R,K,D as _,L as J,G as T,i as q,aU as H,aG as Q,o as f}from"./index-CsrR-wrF.js";import{A as V}from"./PlaylistAddOutlined-CpSMRKtR.js";/* empty css                    */import{G as X}from"./GridToolbarContainer-BVoBlSP0.js";const de=()=>{var S;const c=D(),I=L(),p=(S=O().state)==null?void 0:S.preInspectionChecklistId,[Z,v]=a.useState(""),[ee,N]=a.useState([]),[te,P]=a.useState(""),[x,w]=a.useState([]),[se,F]=a.useState([]),A=a.useRef([]);a.useState({});const[E,ae]=a.useState(!1),{snack:oe,setSnack:m}=a.useContext(W),[h,M]=a.useState(""),[g,$]=a.useState({display:"form",components:[]});U.memo(n=>{const{setRequirements:e,setRowModesModel:d}=n,r=()=>{const i=x==null?void 0:x.reduce((t,u)=>Math.max(t,u.id),0);e(t=>[{id:i+1,requirement:"",isNew:!0},...t]),d(t=>({...t,[i+1]:{mode:Q.Edit,fieldToFocus:"requirement"}}))};return s.jsx(X,{children:s.jsxs(l,{className:"addButtonContainer",mb:1,onClick:r,children:[s.jsx(V,{sx:{mr:1}}),s.jsx(y,{className:"typographyFontWeight",children:"Add Requirement"})]})})}),a.useEffect(()=>{(async()=>{const e=await f({method:"get",url:"http://52.140.64.177:9090/getAllInspectionTypes"});N(e==null?void 0:e.data)})()},[]),a.useEffect(()=>{p&&(async()=>{var r,i,t,u,j,k,C,b;const e=await f({method:"get",url:`http://52.140.64.177:9090/api/pre-inspection-checklist/${p}`});v((r=e==null?void 0:e.data)==null?void 0:r.name),P((t=(i=e==null?void 0:e.data)==null?void 0:i.inspectionType)==null?void 0:t.ins_type_id),(j=(u=e==null?void 0:e.data)==null?void 0:u.requirements)==null||j.map(o=>{const G={id:o==null?void 0:o.id,requirement:o==null?void 0:o.name};w(z=>[...z,G])});const d=(C=(k=e==null?void 0:e.data)==null?void 0:k.requirements)==null?void 0:C.map(o=>o==null?void 0:o.id);F(d),A.current=(b=e==null?void 0:e.data)==null?void 0:b.requirements})()},[p]);const B=async()=>{var n,e,d,r,i;try{if(!h){m({open:!0,message:"Please enter valid form name.",severity:"error"});return}if(((n=g.components)==null?void 0:n.length)===0){m({open:!0,message:"Please add form components.",severity:"error"});return}const t=await f({method:"post",url:"http://52.140.64.177:9090/createForm",data:{name:h,schema:JSON.stringify(g)}});console.log(t),((d=(e=t==null?void 0:t.data)==null?void 0:e.status)==null?void 0:d.toUpperCase())==="SUCCESS"?(m({open:!0,message:(r=t==null?void 0:t.data)==null?void 0:r.message,severity:"success"}),I("/checklist-management/pre-inspection-checklist")):m({open:!0,message:(i=t==null?void 0:t.data)==null?void 0:i.message,severity:"error"})}catch(t){console.log(t)}};return s.jsxs(l,{sx:{borderRadius:"20px",background:`${c.palette.colors[2]} 0% 0% no-repeat padding-box`,my:2,mr:2,p:2.5,boxShadow:`inset 0px 0px 6px ${c.palette.colors[3]}`,opacity:1},children:[s.jsx(R,{sx:{color:c.palette.colors[21],fontSize:"14px",fontWeight:600},startIcon:s.jsx(K,{}),onClick:()=>I(-1),children:"Back"}),s.jsxs(l,{sx:{background:`${c.palette.colors[1]} 0% 0% no-repeat padding-box`,borderRadius:"10px",opacity:1},children:[s.jsx(l,{sx:{py:2,px:2.5},children:s.jsxs(y,{variant:"h4",fontWeight:600,children:[p?"Edit":"Add"," Pre Inspection Checklist"]})}),s.jsx(_,{}),s.jsxs(l,{sx:{py:2,px:2.5,"& .MuiTypography-root":{fontSize:"12px",color:c.palette.colors[21]}},children:[E&&s.jsx(J,{}),s.jsx(T,{container:!0,spacing:3,className:"inputFields",children:s.jsxs(T,{size:4,children:[s.jsxs(y,{children:["Form Name",s.jsx("span",{style:{color:"red"},children:"*"})]}),s.jsx(q,{size:"small",fullWidth:!0,value:h,onChange:n=>M(n.target.value)})]})}),s.jsx(H,{schema:g,setSchema:$}),s.jsx(R,{mt:2,sx:{backgroundColor:c.palette.colors[11],textTransform:"none",borderRadius:"20px",width:"100px",height:"40px",display:"flex",marginLeft:"auto","&:hover":{backgroundColor:c.palette.colors[11]}},onClick:B,children:"Submit"})]})]})]})};export{de as default};
